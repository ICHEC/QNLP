# Build Steps for `intel-qnlp` on *NIX systems

## Load GCC, Intel Compiler and Cmake3 Environments
This step assumes that Environment Modules is used on the system and that GCC version 8.2.0, Intel-2019-u5 and Cmake3 is installed. The module names on your system may vary.

Load modules for GCC version 8.2.0, Intel-2019-u5 and Cmake3.

```
module load gcc/8.2.0 intel/2019u5 cmake3
```

## Build environment configuration
Run the `setup_env.sh` script which pulls down and installs third party software required; Catch2, CLI11,Intel-Quantum Simulator (QS)S, mpi4py and pybind11. Notably, this includes the Intel-QS which executes the quantum gate calls under the hood of the library.

```
./setup_env.sh
```

These dependencies will be installed in `intel-qnlp/third_party/` and `intel-qnlp/third_party/install/`.

Note: this step might take a while to execute.

## Set environment configuration
The `load_env.sh` script was generated by running `setup_env.sh`. It sets the environment variables for all of the dependencies installed in the previous step.

Set the environment variables by running `

```
source load_env.sh
```

## Cmake build steps
Run Cmake to create the Maklefile using the defined environment.
```
cd build
CXX=mpiicpc CC=mpiicc cmake .. -DCMAKE_C_COMPILER=mpiicc -DCMAKE_CXX_COMPILER=mpiicpc -DENABLE_MPI=1 -DENABLE_NATIVE=ON -DIqsMPI=ON -DIqsMKL=ON
```

Include the appropriate flag(s) at the end of the above CMake command to build with the following functionality enabled:
- Unit testing requires the `-DENABLE_TESTS=1` flag
- Gate logging reuires the `-DENABLE_LOGGING=1` flag
- Python bindings enabled (recommended) requires the `-DENABLE_PYTHON=1` flag

(ie. to enable all funtionality for a distributed compute system, run 
```
cd build
CXX=mpiicpc CC=mpiicc cmake .. -DCMAKE_C_COMPILER=mpiicc -DCMAKE_CXX_COMPILER=mpiicpc -DENABLE_MPI=1 -DENABLE_NATIVE=ON -DIqsMPI=ON -DIqsMKL=ON -DENABLE_TESTS=1 -DENABLE_LOGGING=1 -DENABLE_PYTHON=1
```
)
## Build from Makefile
Build the software and third party libraries;

```
make
```



# Build steps for `intel-qnlp` on MacOS Mojave WIP



Note: to build on Mac OS-Mojave, the following command should be run to create the Makefile provided the softaware including Intel-QS was built appropriately for the target environment.
```
cd build
PATH=/opt/gcc/gcc91/bin:$PATH CC=mpicc CXX=mpicxx cmake ..
```



## Note: Running on Mac OS
To run an executable that uses the `intel-qnlp` library, the command must be prepended with the `DYLD_LIBRARY_PATH` path as follows.
```
DYLD_LIBRARY_PATH=/opt/gcc/gcc91/lib:${CONDA_PREFIX}/lib:${DYLD_LIBRARY_PATH} <PATH-TO-EXECUTABLE>/<EXECUTABLE>
```
