<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>QNLP: /Users/mlxd/Desktop/intel-qnlp-rc2/modules/simulator/IntelSimulator.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">QNLP
   &#160;<span id="projectnumber">v1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('a00158_source.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">IntelSimulator.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="a00158.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//##############################################################################</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"></span><span class="comment">//##############################################################################</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="a00167.html">Simulator.hpp</a>&quot;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="a00065.html">GateWriter.hpp</a>&quot;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;qureg/qureg.hpp&quot;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;util/tinymatrix.hpp&quot;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &lt;cstdlib&gt;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &lt;limits&gt;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#ifdef ENABLE_MPI</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">    #include &quot;mpi.h&quot;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="keyword">namespace </span><a class="code" href="a00186.html">QNLP</a>{</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="a00915.html">   35</a></span>&#160;<span class="keyword">class </span><a class="code" href="a00915.html">IntelSimulator</a> : <span class="keyword">public</span> <a class="code" href="a00923.html">SimulatorGeneral</a>&lt;IntelSimulator&gt; {</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keyword">public</span>:</div><div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="a00915.html#a19c3da1a6ca8811caa035c39b3540250">   37</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="a00915.html#a19c3da1a6ca8811caa035c39b3540250">TMDP</a> = qhipster::TinyMatrix&lt;ComplexDP, 2, 2, 32&gt;;</div><div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="a00915.html#a8cb090928af400c512c8aa1b745826ed">   38</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="a00915.html#a8cb090928af400c512c8aa1b745826ed">QRDP</a> = QubitRegister&lt;ComplexDP&gt;;</div><div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="a00915.html#aefafa25d795ca696ee7c44f4ee44017d">   39</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="a00915.html#aefafa25d795ca696ee7c44f4ee44017d">CST</a> = <span class="keyword">const</span> std::size_t;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="a00915.html#a6d4de4ce0949808aa78de821963f872a">   47</a></span>&#160;    <a class="code" href="a00915.html#a6d4de4ce0949808aa78de821963f872a">IntelSimulator</a>(<span class="keywordtype">int</span> <a class="code" href="a00915.html#a76bc3e5b319aa1bda8b10ad422664b35">numQubits</a>, <span class="keywordtype">bool</span> useFusion=<span class="keyword">false</span>) : <a class="code" href="a00923.html">SimulatorGeneral</a>&lt;<a class="code" href="a00915.html">IntelSimulator</a>&gt;(), </div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;                                    <a class="code" href="a00915.html#a76bc3e5b319aa1bda8b10ad422664b35">numQubits</a>(<a class="code" href="a00915.html#a76bc3e5b319aa1bda8b10ad422664b35">numQubits</a>), </div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;                                    <a class="code" href="a00915.html#ab4211903966f86217e50e2e813f7fb4c">qubitRegister</a>(QubitRegister&lt;ComplexDP&gt; (<a class="code" href="a00915.html#a76bc3e5b319aa1bda8b10ad422664b35">numQubits</a>, <span class="stringliteral">&quot;base&quot;</span>, 0)),</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;                                    <a class="code" href="a00915.html#aa1baac16280fbf47655a252e3e3c82d6">gates</a>(5), <a class="code" href="a00915.html#ae49dd87394ea354f2de1fa9269e09442">uid</a>( reinterpret_cast&lt;std::size_t&gt;(this) ){</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <span class="comment">//Define Pauli X</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <a class="code" href="a00915.html#aa1baac16280fbf47655a252e3e3c82d6">gates</a>[0](0,0) = ComplexDP(0.,0.);       <a class="code" href="a00915.html#aa1baac16280fbf47655a252e3e3c82d6">gates</a>[0](0,1) = ComplexDP(1.,0.);</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <a class="code" href="a00915.html#aa1baac16280fbf47655a252e3e3c82d6">gates</a>[0](1,0) = ComplexDP(1.,0.);       <a class="code" href="a00915.html#aa1baac16280fbf47655a252e3e3c82d6">gates</a>[0](1,1) = ComplexDP(0.,0.);</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <span class="comment">//Define Pauli Y</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <a class="code" href="a00915.html#aa1baac16280fbf47655a252e3e3c82d6">gates</a>[1](0,0) = ComplexDP(0.,0.);       <a class="code" href="a00915.html#aa1baac16280fbf47655a252e3e3c82d6">gates</a>[1](0,1) = -ComplexDP(0.,1.);</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <a class="code" href="a00915.html#aa1baac16280fbf47655a252e3e3c82d6">gates</a>[1](1,0) = ComplexDP(0.,1.);       <a class="code" href="a00915.html#aa1baac16280fbf47655a252e3e3c82d6">gates</a>[1](1,1) = ComplexDP(0.,0.);</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <span class="comment">//Define Pauli Z</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <a class="code" href="a00915.html#aa1baac16280fbf47655a252e3e3c82d6">gates</a>[2](0,0) = ComplexDP(1.,0.);       <a class="code" href="a00915.html#aa1baac16280fbf47655a252e3e3c82d6">gates</a>[2](0,1) = ComplexDP(0.,0.);</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <a class="code" href="a00915.html#aa1baac16280fbf47655a252e3e3c82d6">gates</a>[2](1,0) = ComplexDP(0.,0.);       <a class="code" href="a00915.html#aa1baac16280fbf47655a252e3e3c82d6">gates</a>[2](1,1) = ComplexDP(-1.,0.);</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <span class="comment">//Define I</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <a class="code" href="a00915.html#aa1baac16280fbf47655a252e3e3c82d6">gates</a>[3](0,0) = ComplexDP(1.,0.);       <a class="code" href="a00915.html#aa1baac16280fbf47655a252e3e3c82d6">gates</a>[3](0,1) = ComplexDP(0.,0.);</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <a class="code" href="a00915.html#aa1baac16280fbf47655a252e3e3c82d6">gates</a>[3](1,0) = ComplexDP(0.,0.);       <a class="code" href="a00915.html#aa1baac16280fbf47655a252e3e3c82d6">gates</a>[3](1,1) = ComplexDP(1.,0.);</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <span class="comment">//Define Pauli H</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <span class="keywordtype">double</span> coeff = (1./sqrt(2.));</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <a class="code" href="a00915.html#aa1baac16280fbf47655a252e3e3c82d6">gates</a>[4](0,0) = coeff*ComplexDP(1.,0.);   <a class="code" href="a00915.html#aa1baac16280fbf47655a252e3e3c82d6">gates</a>[4](0,1) = coeff*ComplexDP(1.,0.);</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <a class="code" href="a00915.html#aa1baac16280fbf47655a252e3e3c82d6">gates</a>[4](1,0) = coeff*ComplexDP(1.,0.);   <a class="code" href="a00915.html#aa1baac16280fbf47655a252e3e3c82d6">gates</a>[4](1,1) = -coeff*ComplexDP(1.,0.);</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <span class="comment">//Ensure the cache maps are populated before use.</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        this-&gt;<a class="code" href="a00923.html#a363ca18f6710cc1f4bcdb0f4f27aa197">initCaches</a>();</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="preprocessor">        #ifdef ENABLE_MPI //If for some strange reason the MPI environement is not enable through the Base CRTP class, enable using Intel-QS</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            <span class="keywordtype">int</span> mpi_is_init;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            MPI_Initialized(&amp;mpi_is_init);</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            <span class="keywordflow">if</span> (! mpi_is_init){ <span class="comment">// Attempt init using Intel-QS MPI env</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                <span class="keywordtype">int</span> argc_tmp = 0;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                <span class="keywordtype">char</span>** argv_tmp = <span class="keyword">new</span> <span class="keywordtype">char</span>*[argc_tmp];</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                qhipster::mpi::Environment env(argc_tmp, argv_tmp); <span class="comment">//we do not expect to pass any params here</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                <span class="keyword">delete</span> argv_tmp;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            }</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;            MPI_Comm_rank(MPI_COMM_WORLD, &amp;<a class="code" href="a00213.html#a6f94e534a55034c30f887d6e511c7a53">rank</a>);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="preprocessor">        #endif</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <span class="comment">/* Set up random number generator for randomly collapsing qubit to 0 or 1</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">         *</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">         * Note: a random number will be generated on rank 0 and then broadcasted</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">         * to all ranks so that each rank collapses the respective qubit to the</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">         * same value.</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        std::mt19937 mt_(<a class="code" href="a00915.html#a80959381c3720a0d5913fbed8bba47c6">rd</a>()); </div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        std::uniform_real_distribution&lt;double&gt; dist_(0.0,1.0);</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <a class="code" href="a00915.html#aeee1c73eabef7e77a5fb7e4d92078f69">mt</a> = mt_;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <a class="code" href="a00915.html#aadd236084622d0c4e63b2d0b23906df3">dist</a> = dist_;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <span class="keywordflow">if</span>(useFusion == <span class="keyword">true</span>){</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            <a class="code" href="a00915.html#ab4211903966f86217e50e2e813f7fb4c">qubitRegister</a>.TurnOnFusion();</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            std::cerr &lt;&lt; <span class="stringliteral">&quot;Warning: enabling fusion may cause inconsistent results.&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        }</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <a class="code" href="a00915.html#a1d39e14e2dd84806934d5289ea609684">gate_count_1qubit</a> = 0;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <a class="code" href="a00915.html#af1c2b540cd92426d5a176751e9063d9b">gate_count_2qubit</a> = 0;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    }</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="a00915.html#a73f384f66de4ba97cd426c1e5410a78d">  111</a></span>&#160;    <a class="code" href="a00915.html#a73f384f66de4ba97cd426c1e5410a78d">~IntelSimulator</a>(){ }</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="comment">// 1 qubit</span></div><div class="line"><a name="l00121"></a><span class="lineno"><a class="line" href="a00915.html#a8f903350d87f40517431ab2c6af58d19">  121</a></span>&#160;<span class="comment"></span>    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="a00915.html#a8f903350d87f40517431ab2c6af58d19">applyGateU</a>(<span class="keyword">const</span> <a class="code" href="a00915.html#a19c3da1a6ca8811caa035c39b3540250">TMDP</a>&amp; U, <a class="code" href="a00915.html#aefafa25d795ca696ee7c44f4ee44017d">CST</a> qubitIndex, std::string label=<span class="stringliteral">&quot;U&quot;</span>){</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="preprocessor">        #ifndef RESOURCE_ESTIMATE</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <a class="code" href="a00915.html#ab4211903966f86217e50e2e813f7fb4c">qubitRegister</a>.Apply1QubitGate(qubitIndex, U);</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="preprocessor">        #endif</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <a class="code" href="a00915.html#a1d39e14e2dd84806934d5289ea609684">gate_count_1qubit</a>++;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="preprocessor">        #ifdef GATE_LOGGING</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        writer.oneQubitGateCall(label, U.tostr(), qubitIndex);</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="preprocessor">        #endif</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    }</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="a00915.html#a28932132916eef9cfbcc9c0bc992b40a">  138</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="a00915.html#a28932132916eef9cfbcc9c0bc992b40a">applyGateI</a>(std::size_t qubitIndex){</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="preprocessor">        #ifndef RESOURCE_ESTIMATE</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <a class="code" href="a00915.html#a8f903350d87f40517431ab2c6af58d19">applyGateU</a>(<a class="code" href="a00915.html#a887bd799dbd0b5ce4bb556d6e6a87c2e">getGateI</a>(), qubitIndex, <span class="stringliteral">&quot;I&quot;</span>);</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="preprocessor">        #endif</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <a class="code" href="a00915.html#a1d39e14e2dd84806934d5289ea609684">gate_count_1qubit</a>++;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="preprocessor">        #ifdef GATE_LOGGING</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        writer.oneQubitGateCall(<span class="stringliteral">&quot;I&quot;</span>, <a class="code" href="a00915.html#a887bd799dbd0b5ce4bb556d6e6a87c2e">getGateI</a>().tostr(), qubitIndex);</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="preprocessor">        #endif</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    }</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno"><a class="line" href="a00915.html#ac48b25386f58f74dd3d10e627350dbf6">  156</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="a00915.html#ac48b25386f58f74dd3d10e627350dbf6">applyGatePhaseShift</a>(std::size_t qubit_idx, <span class="keywordtype">double</span> angle){</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="comment">//Phase gate is identity with 1,1 index modulated by angle</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <a class="code" href="a00915.html#a19c3da1a6ca8811caa035c39b3540250">TMDP</a> U(<a class="code" href="a00915.html#aa1baac16280fbf47655a252e3e3c82d6">gates</a>[3]);</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        U(1, 1) = ComplexDP(cos(angle), sin(angle));</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="preprocessor">        #ifndef RESOURCE_ESTIMATE</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <a class="code" href="a00915.html#a8f903350d87f40517431ab2c6af58d19">applyGateU</a>(U, qubit_idx, <span class="stringliteral">&quot;Phase:=&quot;</span> + std::to_string(angle));</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="preprocessor">        #endif</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <a class="code" href="a00915.html#a1d39e14e2dd84806934d5289ea609684">gate_count_1qubit</a>++;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="preprocessor">        #ifdef GATE_LOGGING</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        writer.oneQubitGateCall(<span class="stringliteral">&quot;PShift(theta=&quot;</span> + std::to_string(angle) + <span class="stringliteral">&quot;)&quot;</span>, U.tostr(), qubitIndex);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="preprocessor">        #endif</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    }</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="comment">// 2 qubit</span></div><div class="line"><a name="l00180"></a><span class="lineno"><a class="line" href="a00915.html#a62fc6787ce4914d3b6161fb9a76ef08a">  180</a></span>&#160;<span class="comment"></span>    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="a00915.html#a62fc6787ce4914d3b6161fb9a76ef08a">applyGateSqrtSwap</a>(  std::size_t qubit_idx0, std::size_t qubit_idx1){    </div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        std::cerr &lt;&lt; <span class="stringliteral">&quot;NOT YET IMPLEMENTED&quot;</span> &lt;&lt; std::endl; </div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        std::abort();</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    }</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="comment">// 3 qubit</span></div><div class="line"><a name="l00193"></a><span class="lineno"><a class="line" href="a00915.html#ab996963a9a49fcc3d9a07b1b1c8a62a7">  193</a></span>&#160;<span class="comment"></span>    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="a00915.html#ab996963a9a49fcc3d9a07b1b1c8a62a7">applyGateCCX</a>(std::size_t ctrl_qubit0, std::size_t ctrl_qubit1, std::size_t target_qubit){</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        this-&gt;<a class="code" href="a00923.html#a913db3f649fd704afcf75f4f8e9789de">applyGateNCU</a>(this-&gt;<a class="code" href="a00915.html#a7c706fbd851f173bdd16256612a9aff3">getGateX</a>(), std::vector&lt;std::size_t&gt; {ctrl_qubit0, ctrl_qubit1}, target_qubit, <span class="stringliteral">&quot;X&quot;</span>);</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    }</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00205"></a><span class="lineno"><a class="line" href="a00915.html#aa695c0a90d6d780a0f9962e3ac0d2b8f">  205</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="a00915.html#aa695c0a90d6d780a0f9962e3ac0d2b8f">applyGateCSwap</a>(std::size_t ctrl_qubit, std::size_t qubit_swap0, std::size_t qubit_swap1){</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <span class="comment">//V = sqrt(X)</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <a class="code" href="a00915.html#a19c3da1a6ca8811caa035c39b3540250">TMDP</a> V;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        V(0,0) = {0.5,  0.5};</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        V(0,1) = {0.5, -0.5};</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        V(1,0) = {0.5, -0.5};</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        V(1,1) = {0.5,  0.5};</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        </div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        <a class="code" href="a00915.html#a19c3da1a6ca8811caa035c39b3540250">TMDP</a> V_dag;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        V_dag(0,0) = {0.5, -0.5};</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        V_dag(0,1) = {0.5,  0.5};</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        V_dag(1,0) = {0.5,  0.5};</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        V_dag(1,1) = {0.5, -0.5};</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        </div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <a class="code" href="a00915.html#acdf09215d1b39443b770bca3275a340d">applyGateCX</a>(qubit_swap1, qubit_swap0);</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <a class="code" href="a00915.html#a08e6026c906a5ff51554eee2e225d0ad">applyGateCU</a>(V, qubit_swap0, qubit_swap1, <span class="stringliteral">&quot;X&quot;</span>);</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <a class="code" href="a00915.html#a08e6026c906a5ff51554eee2e225d0ad">applyGateCU</a>(V, ctrl_qubit, qubit_swap1, <span class="stringliteral">&quot;X&quot;</span>);</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        </div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <a class="code" href="a00915.html#acdf09215d1b39443b770bca3275a340d">applyGateCX</a>(ctrl_qubit, qubit_swap0);</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <a class="code" href="a00915.html#a08e6026c906a5ff51554eee2e225d0ad">applyGateCU</a>(V_dag, qubit_swap0, qubit_swap1, <span class="stringliteral">&quot;X&quot;</span>);</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <a class="code" href="a00915.html#acdf09215d1b39443b770bca3275a340d">applyGateCX</a>(qubit_swap1, qubit_swap0);</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <a class="code" href="a00915.html#acdf09215d1b39443b770bca3275a340d">applyGateCX</a>(ctrl_qubit, qubit_swap0);</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    }</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="comment">//#################################################</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div><div class="line"><a name="l00236"></a><span class="lineno"><a class="line" href="a00915.html#a3dbe650a7d4634a6c68c464dbc71cb43">  236</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="a00915.html#a3dbe650a7d4634a6c68c464dbc71cb43">applyGateX</a>(<a class="code" href="a00915.html#aefafa25d795ca696ee7c44f4ee44017d">CST</a> qubitIndex){</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="preprocessor">        #ifndef RESOURCE_ESTIMATE</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <a class="code" href="a00915.html#ab4211903966f86217e50e2e813f7fb4c">qubitRegister</a>.ApplyPauliX(qubitIndex);</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="preprocessor">        #endif</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <a class="code" href="a00915.html#a1d39e14e2dd84806934d5289ea609684">gate_count_1qubit</a>++;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="preprocessor">        #ifdef GATE_LOGGING</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        writer.oneQubitGateCall(<span class="stringliteral">&quot;X&quot;</span>, <a class="code" href="a00915.html#a7c706fbd851f173bdd16256612a9aff3">getGateX</a>().tostr(), qubitIndex);</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="preprocessor">        #endif</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    }</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno"><a class="line" href="a00915.html#aaf47c02dc0ca86d12656a3ec6f365923">  253</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="a00915.html#aaf47c02dc0ca86d12656a3ec6f365923">applyGateY</a>(<a class="code" href="a00915.html#aefafa25d795ca696ee7c44f4ee44017d">CST</a> qubitIndex){ </div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="preprocessor">        #ifndef RESOURCE_ESTIMATE</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        <a class="code" href="a00915.html#ab4211903966f86217e50e2e813f7fb4c">qubitRegister</a>.ApplyPauliY(qubitIndex);</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="preprocessor">        #endif</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <a class="code" href="a00915.html#a1d39e14e2dd84806934d5289ea609684">gate_count_1qubit</a>++;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="preprocessor">        #ifdef GATE_LOGGING</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        writer.oneQubitGateCall(<span class="stringliteral">&quot;Y&quot;</span>, <a class="code" href="a00915.html#ac99bc35f19ea72ba763b1e45d3911303">getGateY</a>().tostr(), qubitIndex);</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="preprocessor">        #endif</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    }</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno"><a class="line" href="a00915.html#aca78ef51ed1c912f14dc907506543086">  270</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="a00915.html#aca78ef51ed1c912f14dc907506543086">applyGateZ</a>(<a class="code" href="a00915.html#aefafa25d795ca696ee7c44f4ee44017d">CST</a> qubitIndex){ </div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="preprocessor">        #ifndef RESOURCE_ESTIMATE</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <a class="code" href="a00915.html#ab4211903966f86217e50e2e813f7fb4c">qubitRegister</a>.ApplyPauliZ(qubitIndex);</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="preprocessor">        #endif</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        <a class="code" href="a00915.html#a1d39e14e2dd84806934d5289ea609684">gate_count_1qubit</a>++;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="preprocessor">        #ifdef GATE_LOGGING</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        writer.oneQubitGateCall(<span class="stringliteral">&quot;Z&quot;</span>, <a class="code" href="a00915.html#a129cbf4d467a90ee41b23378059060a5">getGateZ</a>().tostr(), qubitIndex);</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="preprocessor">        #endif</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    }</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div><div class="line"><a name="l00287"></a><span class="lineno"><a class="line" href="a00915.html#a4a4f93789161c8f6db5e90af27a17926">  287</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="a00915.html#a4a4f93789161c8f6db5e90af27a17926">applyGateH</a>(<a class="code" href="a00915.html#aefafa25d795ca696ee7c44f4ee44017d">CST</a> qubitIndex){ </div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="preprocessor">        #ifndef RESOURCE_ESTIMATE</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <a class="code" href="a00915.html#ab4211903966f86217e50e2e813f7fb4c">qubitRegister</a>.ApplyHadamard(qubitIndex);</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="preprocessor">        #endif</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <a class="code" href="a00915.html#a1d39e14e2dd84806934d5289ea609684">gate_count_1qubit</a>++;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="preprocessor">        #ifdef GATE_LOGGING</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        writer.oneQubitGateCall(<span class="stringliteral">&quot;H&quot;</span>, <a class="code" href="a00915.html#abefd66d9f607eb1741e982e0b30f747f">getGateH</a>().tostr(), qubitIndex);</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="preprocessor">        #endif</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    }</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div><div class="line"><a name="l00304"></a><span class="lineno"><a class="line" href="a00915.html#a5c78cca0cfdd70e56fd5c228906c59d4">  304</a></span>&#160;   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="a00915.html#a5c78cca0cfdd70e56fd5c228906c59d4">applyGateSqrtX</a>(<a class="code" href="a00915.html#aefafa25d795ca696ee7c44f4ee44017d">CST</a> qubitIndex){</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="preprocessor">        #ifndef RESOURCE_ESTIMATE</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <a class="code" href="a00915.html#ab4211903966f86217e50e2e813f7fb4c">qubitRegister</a>.ApplyPauliSqrtX(qubitIndex);</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="preprocessor">        #endif</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <a class="code" href="a00915.html#a1d39e14e2dd84806934d5289ea609684">gate_count_1qubit</a>++;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="preprocessor">        #ifdef GATE_LOGGING</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        writer.oneQubitGateCall(</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            <span class="stringliteral">&quot;\\sqrt[2]{X}&quot;</span>, </div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            <a class="code" href="a00923.html#acdbbba66d5941954ed70b9edc0e5174d">matrixSqrt</a>&lt;decltype(<a class="code" href="a00915.html#a7c706fbd851f173bdd16256612a9aff3">getGateX</a>())&gt;(<a class="code" href="a00915.html#a7c706fbd851f173bdd16256612a9aff3">getGateX</a>()).tostr(), </div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            qubitIndex</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        );</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="preprocessor">        #endif</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    };</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div><div class="line"><a name="l00326"></a><span class="lineno"><a class="line" href="a00915.html#a5410fae00e77298bb6a85cabd3eba4f0">  326</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="a00915.html#a5410fae00e77298bb6a85cabd3eba4f0">applyGateRotX</a>(<a class="code" href="a00915.html#aefafa25d795ca696ee7c44f4ee44017d">CST</a> qubitIndex, <span class="keywordtype">double</span> angle) {</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="preprocessor">        #ifndef RESOURCE_ESTIMATE</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <a class="code" href="a00915.html#ab4211903966f86217e50e2e813f7fb4c">qubitRegister</a>.ApplyRotationX(qubitIndex, angle);</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="preprocessor">        #endif</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        <a class="code" href="a00915.html#a1d39e14e2dd84806934d5289ea609684">gate_count_1qubit</a>++;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="preprocessor">        #ifdef GATE_LOGGING</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        writer.oneQubitGateCall(</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            <span class="stringliteral">&quot;R_X(\\theta=&quot;</span> + std::to_string(angle) + <span class="stringliteral">&quot;)&quot;</span>, </div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            <a class="code" href="a00915.html#a887bd799dbd0b5ce4bb556d6e6a87c2e">getGateI</a>().tostr(), </div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            qubitIndex</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        );</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="preprocessor">        #endif</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    };</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div><div class="line"><a name="l00348"></a><span class="lineno"><a class="line" href="a00915.html#a36b27d528184068d64b92f7f8434b1dc">  348</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="a00915.html#a36b27d528184068d64b92f7f8434b1dc">applyGateRotY</a>(<a class="code" href="a00915.html#aefafa25d795ca696ee7c44f4ee44017d">CST</a> qubitIndex, <span class="keywordtype">double</span> angle) {</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="preprocessor">        #ifndef RESOURCE_ESTIMATE</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <a class="code" href="a00915.html#ab4211903966f86217e50e2e813f7fb4c">qubitRegister</a>.ApplyRotationY(qubitIndex, angle);</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="preprocessor">        #endif</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        <a class="code" href="a00915.html#a1d39e14e2dd84806934d5289ea609684">gate_count_1qubit</a>++;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="preprocessor">        #ifdef GATE_LOGGING</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        writer.oneQubitGateCall(</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            <span class="stringliteral">&quot;R_Y(\\theta=&quot;</span> + std::to_string(angle) + <span class="stringliteral">&quot;)&quot;</span>, </div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            <a class="code" href="a00915.html#a887bd799dbd0b5ce4bb556d6e6a87c2e">getGateI</a>().tostr(), </div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            qubitIndex</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        );</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="preprocessor">        #endif</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    };</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;</div><div class="line"><a name="l00370"></a><span class="lineno"><a class="line" href="a00915.html#ab77ddab0c25debb25f5b894ff14c6c2e">  370</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="a00915.html#ab77ddab0c25debb25f5b894ff14c6c2e">applyGateRotZ</a>(<a class="code" href="a00915.html#aefafa25d795ca696ee7c44f4ee44017d">CST</a> qubitIndex, <span class="keywordtype">double</span> angle) {</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="preprocessor">        #ifndef RESOURCE_ESTIMATE</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <a class="code" href="a00915.html#ab4211903966f86217e50e2e813f7fb4c">qubitRegister</a>.ApplyRotationZ(qubitIndex, angle);</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="preprocessor">        #endif</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        <a class="code" href="a00915.html#a1d39e14e2dd84806934d5289ea609684">gate_count_1qubit</a>++;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="preprocessor">        #ifdef GATE_LOGGING</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        writer.oneQubitGateCall(</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;            <span class="stringliteral">&quot;R_Z(\\theta=&quot;</span> + std::to_string(angle) + <span class="stringliteral">&quot;)&quot;</span>, </div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            <a class="code" href="a00915.html#a887bd799dbd0b5ce4bb556d6e6a87c2e">getGateI</a>().tostr(), </div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            qubitIndex</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        );</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="preprocessor">        #endif</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    };</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div><div class="line"><a name="l00390"></a><span class="lineno"><a class="line" href="a00915.html#a7c706fbd851f173bdd16256612a9aff3">  390</a></span>&#160;    <span class="keyword">inline</span> <a class="code" href="a00915.html#a19c3da1a6ca8811caa035c39b3540250">TMDP</a> <a class="code" href="a00915.html#a7c706fbd851f173bdd16256612a9aff3">getGateX</a>(){ <span class="keywordflow">return</span> <a class="code" href="a00915.html#aa1baac16280fbf47655a252e3e3c82d6">gates</a>[0]; }</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div><div class="line"><a name="l00396"></a><span class="lineno"><a class="line" href="a00915.html#ac99bc35f19ea72ba763b1e45d3911303">  396</a></span>&#160;    <span class="keyword">inline</span> <a class="code" href="a00915.html#a19c3da1a6ca8811caa035c39b3540250">TMDP</a> <a class="code" href="a00915.html#ac99bc35f19ea72ba763b1e45d3911303">getGateY</a>(){ <span class="keywordflow">return</span> <a class="code" href="a00915.html#aa1baac16280fbf47655a252e3e3c82d6">gates</a>[1]; }</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div><div class="line"><a name="l00402"></a><span class="lineno"><a class="line" href="a00915.html#a129cbf4d467a90ee41b23378059060a5">  402</a></span>&#160;    <span class="keyword">inline</span> <a class="code" href="a00915.html#a19c3da1a6ca8811caa035c39b3540250">TMDP</a> <a class="code" href="a00915.html#a129cbf4d467a90ee41b23378059060a5">getGateZ</a>(){ <span class="keywordflow">return</span> <a class="code" href="a00915.html#aa1baac16280fbf47655a252e3e3c82d6">gates</a>[2]; }</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div><div class="line"><a name="l00408"></a><span class="lineno"><a class="line" href="a00915.html#a887bd799dbd0b5ce4bb556d6e6a87c2e">  408</a></span>&#160;    <span class="keyword">inline</span> <a class="code" href="a00915.html#a19c3da1a6ca8811caa035c39b3540250">TMDP</a> <a class="code" href="a00915.html#a887bd799dbd0b5ce4bb556d6e6a87c2e">getGateI</a>(){ <span class="keywordflow">return</span> <a class="code" href="a00915.html#aa1baac16280fbf47655a252e3e3c82d6">gates</a>[3]; }</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div><div class="line"><a name="l00414"></a><span class="lineno"><a class="line" href="a00915.html#abefd66d9f607eb1741e982e0b30f747f">  414</a></span>&#160;    <span class="keyword">inline</span> <a class="code" href="a00915.html#a19c3da1a6ca8811caa035c39b3540250">TMDP</a> <a class="code" href="a00915.html#abefd66d9f607eb1741e982e0b30f747f">getGateH</a>(){ <span class="keywordflow">return</span> <a class="code" href="a00915.html#aa1baac16280fbf47655a252e3e3c82d6">gates</a>[4]; }</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div><div class="line"><a name="l00424"></a><span class="lineno"><a class="line" href="a00915.html#a08e6026c906a5ff51554eee2e225d0ad">  424</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="a00915.html#a08e6026c906a5ff51554eee2e225d0ad">applyGateCU</a>(<span class="keyword">const</span> <a class="code" href="a00915.html#a19c3da1a6ca8811caa035c39b3540250">TMDP</a>&amp; U, <a class="code" href="a00915.html#aefafa25d795ca696ee7c44f4ee44017d">CST</a> control, <a class="code" href="a00915.html#aefafa25d795ca696ee7c44f4ee44017d">CST</a> <a class="code" href="a00213.html#a04d504e3a1d9b0157c4d2d1de832d0ed">target</a>, std::string label=<span class="stringliteral">&quot;U&quot;</span>){</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="preprocessor">        #ifndef RESOURCE_ESTIMATE</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <a class="code" href="a00915.html#ab4211903966f86217e50e2e813f7fb4c">qubitRegister</a>.ApplyControlled1QubitGate(control, <a class="code" href="a00213.html#a04d504e3a1d9b0157c4d2d1de832d0ed">target</a>, U);</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="preprocessor">        #endif</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <a class="code" href="a00915.html#af1c2b540cd92426d5a176751e9063d9b">gate_count_2qubit</a>++;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="preprocessor">        #ifdef GATE_LOGGING</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        writer.twoQubitGateCall( label, U.tostr(), control, <a class="code" href="a00213.html#a04d504e3a1d9b0157c4d2d1de832d0ed">target</a> );</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="preprocessor">        #endif</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    }</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div><div class="line"><a name="l00442"></a><span class="lineno"><a class="line" href="a00915.html#acdf09215d1b39443b770bca3275a340d">  442</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="a00915.html#acdf09215d1b39443b770bca3275a340d">applyGateCX</a>(<a class="code" href="a00915.html#aefafa25d795ca696ee7c44f4ee44017d">CST</a> control, <a class="code" href="a00915.html#aefafa25d795ca696ee7c44f4ee44017d">CST</a> <a class="code" href="a00213.html#a04d504e3a1d9b0157c4d2d1de832d0ed">target</a>){</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="preprocessor">        #ifndef RESOURCE_ESTIMATE</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        <a class="code" href="a00915.html#ab4211903966f86217e50e2e813f7fb4c">qubitRegister</a>.ApplyCPauliX(control, <a class="code" href="a00213.html#a04d504e3a1d9b0157c4d2d1de832d0ed">target</a>);</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="preprocessor">        #endif</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        <a class="code" href="a00915.html#af1c2b540cd92426d5a176751e9063d9b">gate_count_2qubit</a>++;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="preprocessor">        #ifdef GATE_LOGGING</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        writer.twoQubitGateCall( <span class="stringliteral">&quot;X&quot;</span>, <a class="code" href="a00915.html#a7c706fbd851f173bdd16256612a9aff3">getGateX</a>().tostr(), control, <a class="code" href="a00213.html#a04d504e3a1d9b0157c4d2d1de832d0ed">target</a> );</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="preprocessor">        #endif</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    }</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;</div><div class="line"><a name="l00460"></a><span class="lineno"><a class="line" href="a00915.html#af2c1644dec4b763dbb588f467b3b536f">  460</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="a00915.html#af2c1644dec4b763dbb588f467b3b536f">applyGateCY</a>(<a class="code" href="a00915.html#aefafa25d795ca696ee7c44f4ee44017d">CST</a> control, <a class="code" href="a00915.html#aefafa25d795ca696ee7c44f4ee44017d">CST</a> <a class="code" href="a00213.html#a04d504e3a1d9b0157c4d2d1de832d0ed">target</a>){</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="preprocessor">        #ifndef RESOURCE_ESTIMATE</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        <a class="code" href="a00915.html#ab4211903966f86217e50e2e813f7fb4c">qubitRegister</a>.ApplyCPauliY(control, <a class="code" href="a00213.html#a04d504e3a1d9b0157c4d2d1de832d0ed">target</a>);</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="preprocessor">        #endif</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        <a class="code" href="a00915.html#af1c2b540cd92426d5a176751e9063d9b">gate_count_2qubit</a>++;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="preprocessor">        #ifdef GATE_LOGGING</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        writer.twoQubitGateCall( <span class="stringliteral">&quot;Y&quot;</span>, <a class="code" href="a00915.html#ac99bc35f19ea72ba763b1e45d3911303">getGateY</a>().tostr(), control, <a class="code" href="a00213.html#a04d504e3a1d9b0157c4d2d1de832d0ed">target</a> );</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="preprocessor">        #endif</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    }</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;</div><div class="line"><a name="l00478"></a><span class="lineno"><a class="line" href="a00915.html#a46719f99c713d54a948b3da6425db4f7">  478</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="a00915.html#a46719f99c713d54a948b3da6425db4f7">applyGateCZ</a>(<a class="code" href="a00915.html#aefafa25d795ca696ee7c44f4ee44017d">CST</a> control, <a class="code" href="a00915.html#aefafa25d795ca696ee7c44f4ee44017d">CST</a> <a class="code" href="a00213.html#a04d504e3a1d9b0157c4d2d1de832d0ed">target</a>){</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="preprocessor">        #ifndef RESOURCE_ESTIMATE</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        <a class="code" href="a00915.html#ab4211903966f86217e50e2e813f7fb4c">qubitRegister</a>.ApplyCPauliZ(control, <a class="code" href="a00213.html#a04d504e3a1d9b0157c4d2d1de832d0ed">target</a>);</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="preprocessor">        #endif</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        <a class="code" href="a00915.html#af1c2b540cd92426d5a176751e9063d9b">gate_count_2qubit</a>++;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="preprocessor">        #ifdef GATE_LOGGING</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        writer.twoQubitGateCall( <span class="stringliteral">&quot;Z&quot;</span>, <a class="code" href="a00915.html#a129cbf4d467a90ee41b23378059060a5">getGateZ</a>().tostr(), control, <a class="code" href="a00213.html#a04d504e3a1d9b0157c4d2d1de832d0ed">target</a> );</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="preprocessor">        #endif</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    }</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;</div><div class="line"><a name="l00496"></a><span class="lineno"><a class="line" href="a00915.html#a6bcf77000411cf461ab73ebf0854cded">  496</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="a00915.html#a6bcf77000411cf461ab73ebf0854cded">applyGateCH</a>(<a class="code" href="a00915.html#aefafa25d795ca696ee7c44f4ee44017d">CST</a> control, <a class="code" href="a00915.html#aefafa25d795ca696ee7c44f4ee44017d">CST</a> <a class="code" href="a00213.html#a04d504e3a1d9b0157c4d2d1de832d0ed">target</a>){</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="preprocessor">        #ifndef RESOURCE_ESTIMATE</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        <a class="code" href="a00915.html#ab4211903966f86217e50e2e813f7fb4c">qubitRegister</a>.ApplyCHadamard(control, <a class="code" href="a00213.html#a04d504e3a1d9b0157c4d2d1de832d0ed">target</a>);</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="preprocessor">        #endif</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        <a class="code" href="a00915.html#af1c2b540cd92426d5a176751e9063d9b">gate_count_2qubit</a>++;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="preprocessor">        #ifdef GATE_LOGGING</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        writer.twoQubitGateCall( <span class="stringliteral">&quot;H&quot;</span>, <a class="code" href="a00915.html#abefd66d9f607eb1741e982e0b30f747f">getGateH</a>().tostr(), control, <a class="code" href="a00213.html#a04d504e3a1d9b0157c4d2d1de832d0ed">target</a> );</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="preprocessor">        #endif</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    }</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;</div><div class="line"><a name="l00515"></a><span class="lineno"><a class="line" href="a00915.html#a0a3948c5a2d3ce931c865585a677e4ea">  515</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="a00915.html#a0a3948c5a2d3ce931c865585a677e4ea">applyGateCPhaseShift</a>(<span class="keywordtype">double</span> angle, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> control, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="a00213.html#a04d504e3a1d9b0157c4d2d1de832d0ed">target</a>){</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        <a class="code" href="a00915.html#a19c3da1a6ca8811caa035c39b3540250">TMDP</a> U(<a class="code" href="a00915.html#aa1baac16280fbf47655a252e3e3c82d6">gates</a>[3]);</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        U(1, 1) = ComplexDP(cos(angle), sin(angle));</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="preprocessor">        #ifndef RESOURCE_ESTIMATE</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        <a class="code" href="a00915.html#ab4211903966f86217e50e2e813f7fb4c">qubitRegister</a>.ApplyControlled1QubitGate(control, <a class="code" href="a00213.html#a04d504e3a1d9b0157c4d2d1de832d0ed">target</a>, U);</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="preprocessor">        #endif</span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        <a class="code" href="a00915.html#af1c2b540cd92426d5a176751e9063d9b">gate_count_2qubit</a>++;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="preprocessor">        #ifdef GATE_LOGGING</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        writer.twoQubitGateCall( <span class="stringliteral">&quot;CPhase&quot;</span>, U.tostr(), control, <a class="code" href="a00213.html#a04d504e3a1d9b0157c4d2d1de832d0ed">target</a> );</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="preprocessor">        #endif</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    }</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;</div><div class="line"><a name="l00537"></a><span class="lineno"><a class="line" href="a00915.html#ac9eae7e6b74e12796655a5f142ccd32b">  537</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="a00915.html#ac9eae7e6b74e12796655a5f142ccd32b">applyGateCRotX</a>(<a class="code" href="a00915.html#aefafa25d795ca696ee7c44f4ee44017d">CST</a> control, <a class="code" href="a00915.html#aefafa25d795ca696ee7c44f4ee44017d">CST</a> <a class="code" href="a00213.html#a04d504e3a1d9b0157c4d2d1de832d0ed">target</a>, <span class="keyword">const</span> <span class="keywordtype">double</span> theta){</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="preprocessor">        #ifndef RESOURCE_ESTIMATE</span></div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        <a class="code" href="a00915.html#ab4211903966f86217e50e2e813f7fb4c">qubitRegister</a>.ApplyCRotationX(control, <a class="code" href="a00213.html#a04d504e3a1d9b0157c4d2d1de832d0ed">target</a>, theta);</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="preprocessor">        #endif</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        <a class="code" href="a00915.html#af1c2b540cd92426d5a176751e9063d9b">gate_count_2qubit</a>++;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="preprocessor">        #ifdef GATE_LOGGING</span></div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        writer.twoQubitGateCall( <span class="stringliteral">&quot;CR_X&quot;</span>, <a class="code" href="a00915.html#a887bd799dbd0b5ce4bb556d6e6a87c2e">getGateI</a>().tostr(), control, <a class="code" href="a00213.html#a04d504e3a1d9b0157c4d2d1de832d0ed">target</a> );</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="preprocessor">        #endif</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    }</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;</div><div class="line"><a name="l00556"></a><span class="lineno"><a class="line" href="a00915.html#a24f5444aac8c1c79c491f086e6871fb5">  556</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="a00915.html#a24f5444aac8c1c79c491f086e6871fb5">applyGateCRotY</a>(<a class="code" href="a00915.html#aefafa25d795ca696ee7c44f4ee44017d">CST</a> control, <a class="code" href="a00915.html#aefafa25d795ca696ee7c44f4ee44017d">CST</a> <a class="code" href="a00213.html#a04d504e3a1d9b0157c4d2d1de832d0ed">target</a>, <span class="keywordtype">double</span> theta){</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="preprocessor">        #ifndef RESOURCE_ESTIMATE</span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        <a class="code" href="a00915.html#ab4211903966f86217e50e2e813f7fb4c">qubitRegister</a>.ApplyCRotationY(control, <a class="code" href="a00213.html#a04d504e3a1d9b0157c4d2d1de832d0ed">target</a>, theta);</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="preprocessor">        #endif</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        <a class="code" href="a00915.html#af1c2b540cd92426d5a176751e9063d9b">gate_count_2qubit</a>++;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="preprocessor">        #ifdef GATE_LOGGING</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        writer.twoQubitGateCall( <span class="stringliteral">&quot;CR_Y&quot;</span>, <a class="code" href="a00915.html#a887bd799dbd0b5ce4bb556d6e6a87c2e">getGateI</a>().tostr(), control, <a class="code" href="a00213.html#a04d504e3a1d9b0157c4d2d1de832d0ed">target</a> );</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="preprocessor">        #endif</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    }</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;</div><div class="line"><a name="l00575"></a><span class="lineno"><a class="line" href="a00915.html#ab000ae3085d5c352d8de5bc641d3897b">  575</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="a00915.html#ab000ae3085d5c352d8de5bc641d3897b">applyGateCRotZ</a>(<a class="code" href="a00915.html#aefafa25d795ca696ee7c44f4ee44017d">CST</a> control, <a class="code" href="a00915.html#aefafa25d795ca696ee7c44f4ee44017d">CST</a> <a class="code" href="a00213.html#a04d504e3a1d9b0157c4d2d1de832d0ed">target</a>, <span class="keyword">const</span> <span class="keywordtype">double</span> theta){</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="preprocessor">        #ifndef RESOURCE_ESTIMATE</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        <a class="code" href="a00915.html#ab4211903966f86217e50e2e813f7fb4c">qubitRegister</a>.ApplyCRotationZ(control, <a class="code" href="a00213.html#a04d504e3a1d9b0157c4d2d1de832d0ed">target</a>, theta);</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="preprocessor">        #endif</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        </div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        <a class="code" href="a00915.html#af1c2b540cd92426d5a176751e9063d9b">gate_count_2qubit</a>++;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        </div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="preprocessor">        #ifdef GATE_LOGGING</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        writer.twoQubitGateCall( <span class="stringliteral">&quot;CR_Z&quot;</span>, <a class="code" href="a00915.html#a887bd799dbd0b5ce4bb556d6e6a87c2e">getGateI</a>().tostr(), control, <a class="code" href="a00213.html#a04d504e3a1d9b0157c4d2d1de832d0ed">target</a> );</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="preprocessor">        #endif</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    }</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;</div><div class="line"><a name="l00593"></a><span class="lineno"><a class="line" href="a00915.html#a0dfad24a46b55360a0cd8c329d2bbe8f">  593</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="a00915.html#a0dfad24a46b55360a0cd8c329d2bbe8f">applyGateSwap</a>(<a class="code" href="a00915.html#aefafa25d795ca696ee7c44f4ee44017d">CST</a> qubit_idx0, <a class="code" href="a00915.html#aefafa25d795ca696ee7c44f4ee44017d">CST</a> qubit_idx1){</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        <a class="code" href="a00915.html#ab4211903966f86217e50e2e813f7fb4c">qubitRegister</a>.ApplySwap(qubit_idx0, qubit_idx1);</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="preprocessor">        #ifdef GATE_LOGGING</span></div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        writer.twoQubitGateCall( <span class="stringliteral">&quot;SWAP&quot;</span>, <a class="code" href="a00915.html#a887bd799dbd0b5ce4bb556d6e6a87c2e">getGateI</a>().tostr(), qubit_idx0, qubit_idx1 );</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="preprocessor">        #endif</span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    }</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div><div class="line"><a name="l00605"></a><span class="lineno"><a class="line" href="a00915.html#ad8f8e0e08d4154218c80c863b2a53748">  605</a></span>&#160;    <span class="keyword">inline</span> QubitRegister&lt;ComplexDP&gt;&amp; <a class="code" href="a00915.html#ad8f8e0e08d4154218c80c863b2a53748">getQubitRegister</a>() { </div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        <span class="keywordflow">return</span> this-&gt;<a class="code" href="a00915.html#ab4211903966f86217e50e2e813f7fb4c">qubitRegister</a>; </div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    }</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div><div class="line"><a name="l00614"></a><span class="lineno"><a class="line" href="a00915.html#a43a6f6053266f2df36ed2ad96224ed62">  614</a></span>&#160;    <span class="keyword">inline</span> <span class="keyword">const</span> QubitRegister&lt;ComplexDP&gt;&amp; <a class="code" href="a00915.html#a43a6f6053266f2df36ed2ad96224ed62">getQubitRegister</a>()<span class="keyword"> const </span>{ </div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        <span class="keywordflow">return</span> this-&gt;<a class="code" href="a00915.html#ab4211903966f86217e50e2e813f7fb4c">qubitRegister</a>; </div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    };</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;</div><div class="line"><a name="l00623"></a><span class="lineno"><a class="line" href="a00915.html#a6f85ad3d770635f47de48628c7d30335">  623</a></span>&#160;    std::size_t <a class="code" href="a00915.html#a6f85ad3d770635f47de48628c7d30335">getNumQubits</a>() { </div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="a00915.html#a76bc3e5b319aa1bda8b10ad422664b35">numQubits</a>; </div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    }</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;</div><div class="line"><a name="l00631"></a><span class="lineno"><a class="line" href="a00915.html#a581abd823527de7995b96733f543400f">  631</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="a00915.html#a581abd823527de7995b96733f543400f">initRegister</a>(){</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        this-&gt;<a class="code" href="a00915.html#ab4211903966f86217e50e2e813f7fb4c">qubitRegister</a>.Initialize(<span class="stringliteral">&quot;base&quot;</span>,0);</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        this-&gt;<a class="code" href="a00923.html#a363ca18f6710cc1f4bcdb0f4f27aa197">initCaches</a>();</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        <a class="code" href="a00915.html#a1d39e14e2dd84806934d5289ea609684">gate_count_1qubit</a> = 0;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        <a class="code" href="a00915.html#af1c2b540cd92426d5a176751e9063d9b">gate_count_2qubit</a> = 0;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    }</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;</div><div class="line"><a name="l00642"></a><span class="lineno"><a class="line" href="a00915.html#ad994a3061e6e9901f81a1a872852baf5">  642</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="a00915.html#ad994a3061e6e9901f81a1a872852baf5">applyAmplitudeNorm</a>(){</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        this-&gt;<a class="code" href="a00915.html#ab4211903966f86217e50e2e813f7fb4c">qubitRegister</a>.Normalize();</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    }</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;</div><div class="line"><a name="l00653"></a><span class="lineno"><a class="line" href="a00915.html#a1f4431219d1382604100f5a121b0cacd">  653</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="a00915.html#a1f4431219d1382604100f5a121b0cacd">applyMeasurement</a>(<a class="code" href="a00915.html#aefafa25d795ca696ee7c44f4ee44017d">CST</a> <a class="code" href="a00213.html#a04d504e3a1d9b0157c4d2d1de832d0ed">target</a>, <span class="keywordtype">bool</span> normalize=<span class="keyword">true</span>){</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        <span class="keywordtype">double</span> rand;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        <span class="keywordtype">bool</span> bit_val;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="preprocessor">        #ifdef ENABLE_MPI</span></div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="a00213.html#a6f94e534a55034c30f887d6e511c7a53">rank</a> == 0){</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                rand = <a class="code" href="a00915.html#aadd236084622d0c4e63b2d0b23906df3">dist</a>(<a class="code" href="a00915.html#aeee1c73eabef7e77a5fb7e4d92078f69">mt</a>);</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;            }</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;            MPI_Bcast(&amp;rand, 1, MPI_DOUBLE, 0, MPI_COMM_WORLD);</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;            MPI_Barrier(MPI_COMM_WORLD);</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="preprocessor">        #else</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;            rand = <a class="code" href="a00915.html#aadd236084622d0c4e63b2d0b23906df3">dist</a>(<a class="code" href="a00915.html#aeee1c73eabef7e77a5fb7e4d92078f69">mt</a>);</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="preprocessor">        #endif</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        <a class="code" href="a00915.html#a1e3a2ffb531f7f8fbbe032619e9be1f3">collapseQubit</a>(<a class="code" href="a00213.html#a04d504e3a1d9b0157c4d2d1de832d0ed">target</a>, (bit_val = ( rand &lt; <a class="code" href="a00915.html#a51bf3d357cec1d6fa1e2ac98a604307c">getStateProbability</a>(<a class="code" href="a00213.html#a04d504e3a1d9b0157c4d2d1de832d0ed">target</a>) ) ) );</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        <span class="keywordflow">if</span>(normalize){</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;            <a class="code" href="a00915.html#ad994a3061e6e9901f81a1a872852baf5">applyAmplitudeNorm</a>();</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        }</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        <span class="keywordflow">return</span> bit_val;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    }</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;</div><div class="line"><a name="l00679"></a><span class="lineno"><a class="line" href="a00915.html#a9bf211252e52181d0fb6a40845a5cd10">  679</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="a00915.html#a9bf211252e52181d0fb6a40845a5cd10">collapseToBasisZ</a>(<a class="code" href="a00915.html#aefafa25d795ca696ee7c44f4ee44017d">CST</a> <a class="code" href="a00213.html#a04d504e3a1d9b0157c4d2d1de832d0ed">target</a>, <span class="keywordtype">bool</span> collapseValue){</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        <a class="code" href="a00915.html#a1e3a2ffb531f7f8fbbe032619e9be1f3">collapseQubit</a>(<a class="code" href="a00213.html#a04d504e3a1d9b0157c4d2d1de832d0ed">target</a>, collapseValue);</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        <a class="code" href="a00915.html#ad994a3061e6e9901f81a1a872852baf5">applyAmplitudeNorm</a>();</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    }</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;</div><div class="line"><a name="l00690"></a><span class="lineno"><a class="line" href="a00915.html#a82d309be4f120c7d9083ea2c575b2593">  690</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="a00915.html#a82d309be4f120c7d9083ea2c575b2593">PrintStates</a>(std::string <a class="code" href="a00214.html#a4f33114707dbbca9a2fdf04086d1c89b">x</a>, std::vector&lt;std::size_t&gt; qubits = {}){</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;        <a class="code" href="a00915.html#ab4211903966f86217e50e2e813f7fb4c">qubitRegister</a>.Print(<a class="code" href="a00214.html#a4f33114707dbbca9a2fdf04086d1c89b">x</a>,qubits);</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    }</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="preprocessor">    #ifdef GATE_LOGGING</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    GateWriter&amp; getGateWriter(){</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        <span class="keywordflow">return</span> writer;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    } </div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="preprocessor">    #endif</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;</div><div class="line"><a name="l00709"></a><span class="lineno"><a class="line" href="a00915.html#ad4e8dfa039aceddd2918675c0e99daed">  709</a></span>&#160;    std::pair&lt;std::size_t, std::size_t&gt; <a class="code" href="a00915.html#ad4e8dfa039aceddd2918675c0e99daed">getGateCounts</a>(){</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;######### Gate counts #########&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;1 qubit = &quot;</span> &lt;&lt; <a class="code" href="a00915.html#a1d39e14e2dd84806934d5289ea609684">gate_count_1qubit</a> &lt;&lt; std::endl;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;2 qubit = &quot;</span> &lt;&lt; <a class="code" href="a00915.html#af1c2b540cd92426d5a176751e9063d9b">gate_count_2qubit</a> &lt;&lt; std::endl;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;total = &quot;</span> &lt;&lt; <a class="code" href="a00915.html#a1d39e14e2dd84806934d5289ea609684">gate_count_1qubit</a> + <a class="code" href="a00915.html#af1c2b540cd92426d5a176751e9063d9b">gate_count_2qubit</a> &lt;&lt; std::endl;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;###############################&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        <span class="keywordflow">return</span> std::make_pair(<a class="code" href="a00915.html#a1d39e14e2dd84806934d5289ea609684">gate_count_1qubit</a>, <a class="code" href="a00915.html#af1c2b540cd92426d5a176751e9063d9b">gate_count_2qubit</a>);</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    }</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;</div><div class="line"><a name="l00723"></a><span class="lineno"><a class="line" href="a00915.html#aa26612617dcd33ca2ab74be8bd23bc29">  723</a></span>&#160;    <span class="keyword">inline</span> complex&lt;double&gt; <a class="code" href="a00915.html#aa26612617dcd33ca2ab74be8bd23bc29">overlap</a>( <a class="code" href="a00915.html">IntelSimulator</a> &amp;<a class="code" href="a00213.html#ae184342e3a272e0fc184cff4ad95be05">sim</a>){</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="a00213.html#ae184342e3a272e0fc184cff4ad95be05">sim</a>.uid != this-&gt;uid){</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="a00915.html#ab4211903966f86217e50e2e813f7fb4c">qubitRegister</a>.ComputeOverlap(<a class="code" href="a00213.html#ae184342e3a272e0fc184cff4ad95be05">sim</a>.qubitRegister);</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        }</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        <span class="keywordflow">else</span>{</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;            <span class="keywordflow">return</span> std::numeric_limits&lt;double&gt;::quiet_NaN();</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        }</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    }</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    <span class="keyword">private</span>:</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <span class="comment">//inline static std::size_t suid = 0; //works in C++17.</span></div><div class="line"><a name="l00734"></a><span class="lineno"><a class="line" href="a00915.html#ae49dd87394ea354f2de1fa9269e09442">  734</a></span>&#160;    <span class="keyword">const</span> std::size_t <a class="code" href="a00915.html#ae49dd87394ea354f2de1fa9269e09442">uid</a>;</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;</div><div class="line"><a name="l00736"></a><span class="lineno"><a class="line" href="a00915.html#a76bc3e5b319aa1bda8b10ad422664b35">  736</a></span>&#160;    std::size_t <a class="code" href="a00915.html#a76bc3e5b319aa1bda8b10ad422664b35">numQubits</a> = 0;</div><div class="line"><a name="l00737"></a><span class="lineno"><a class="line" href="a00915.html#ab4211903966f86217e50e2e813f7fb4c">  737</a></span>&#160;    <a class="code" href="a00915.html#a8cb090928af400c512c8aa1b745826ed">QRDP</a> <a class="code" href="a00915.html#ab4211903966f86217e50e2e813f7fb4c">qubitRegister</a>;</div><div class="line"><a name="l00738"></a><span class="lineno"><a class="line" href="a00915.html#aa1baac16280fbf47655a252e3e3c82d6">  738</a></span>&#160;    std::vector&lt;TMDP&gt; <a class="code" href="a00915.html#aa1baac16280fbf47655a252e3e3c82d6">gates</a>;</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="preprocessor">    #ifdef ENABLE_MPI</span></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="a00213.html#a6f94e534a55034c30f887d6e511c7a53">rank</a>;</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="preprocessor">    #endif</span></div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;</div><div class="line"><a name="l00743"></a><span class="lineno"><a class="line" href="a00915.html#a1d39e14e2dd84806934d5289ea609684">  743</a></span>&#160;    std::size_t <a class="code" href="a00915.html#a1d39e14e2dd84806934d5289ea609684">gate_count_1qubit</a>;</div><div class="line"><a name="l00744"></a><span class="lineno"><a class="line" href="a00915.html#af1c2b540cd92426d5a176751e9063d9b">  744</a></span>&#160;    std::size_t <a class="code" href="a00915.html#af1c2b540cd92426d5a176751e9063d9b">gate_count_2qubit</a>;</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;</div><div class="line"><a name="l00746"></a><span class="lineno"><a class="line" href="a00915.html#a80959381c3720a0d5913fbed8bba47c6">  746</a></span>&#160;    std::random_device <a class="code" href="a00915.html#a80959381c3720a0d5913fbed8bba47c6">rd</a>; </div><div class="line"><a name="l00747"></a><span class="lineno"><a class="line" href="a00915.html#aeee1c73eabef7e77a5fb7e4d92078f69">  747</a></span>&#160;    std::mt19937 <a class="code" href="a00915.html#aeee1c73eabef7e77a5fb7e4d92078f69">mt</a>;</div><div class="line"><a name="l00748"></a><span class="lineno"><a class="line" href="a00915.html#aadd236084622d0c4e63b2d0b23906df3">  748</a></span>&#160;    std::uniform_real_distribution&lt;double&gt; <a class="code" href="a00915.html#aadd236084622d0c4e63b2d0b23906df3">dist</a>;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    <span class="comment">// Measurement methods</span></div><div class="line"><a name="l00758"></a><span class="lineno"><a class="line" href="a00915.html#a1e3a2ffb531f7f8fbbe032619e9be1f3">  758</a></span>&#160;<span class="comment"></span>    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="a00915.html#a1e3a2ffb531f7f8fbbe032619e9be1f3">collapseQubit</a>(<a class="code" href="a00915.html#aefafa25d795ca696ee7c44f4ee44017d">CST</a> <a class="code" href="a00213.html#a04d504e3a1d9b0157c4d2d1de832d0ed">target</a>, <span class="keywordtype">bool</span> collapseValue){</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        <a class="code" href="a00915.html#ab4211903966f86217e50e2e813f7fb4c">qubitRegister</a>.CollapseQubit(<a class="code" href="a00213.html#a04d504e3a1d9b0157c4d2d1de832d0ed">target</a>, collapseValue);</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    }</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;</div><div class="line"><a name="l00768"></a><span class="lineno"><a class="line" href="a00915.html#a51bf3d357cec1d6fa1e2ac98a604307c">  768</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="a00915.html#a51bf3d357cec1d6fa1e2ac98a604307c">getStateProbability</a>(<a class="code" href="a00915.html#aefafa25d795ca696ee7c44f4ee44017d">CST</a> <a class="code" href="a00213.html#a04d504e3a1d9b0157c4d2d1de832d0ed">target</a>){</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="a00915.html#ab4211903966f86217e50e2e813f7fb4c">qubitRegister</a>.GetProbability(<a class="code" href="a00213.html#a04d504e3a1d9b0157c4d2d1de832d0ed">target</a>);</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    }</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;};</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;};</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;</div><div class="ttc" id="a00915_html_ac9eae7e6b74e12796655a5f142ccd32b"><div class="ttname"><a href="a00915.html#ac9eae7e6b74e12796655a5f142ccd32b">QNLP::IntelSimulator::applyGateCRotX</a></div><div class="ttdeci">void applyGateCRotX(CST control, CST target, const double theta)</div><div class="ttdoc">Apply the given Controlled Rotation about X-axis to the given qubit.</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00537">IntelSimulator.cpp:537</a></div></div>
<div class="ttc" id="a00915_html_af1c2b540cd92426d5a176751e9063d9b"><div class="ttname"><a href="a00915.html#af1c2b540cd92426d5a176751e9063d9b">QNLP::IntelSimulator::gate_count_2qubit</a></div><div class="ttdeci">std::size_t gate_count_2qubit</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00744">IntelSimulator.cpp:744</a></div></div>
<div class="ttc" id="a00915_html_ae49dd87394ea354f2de1fa9269e09442"><div class="ttname"><a href="a00915.html#ae49dd87394ea354f2de1fa9269e09442">QNLP::IntelSimulator::uid</a></div><div class="ttdeci">const std::size_t uid</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00734">IntelSimulator.cpp:734</a></div></div>
<div class="ttc" id="a00915_html_aca78ef51ed1c912f14dc907506543086"><div class="ttname"><a href="a00915.html#aca78ef51ed1c912f14dc907506543086">QNLP::IntelSimulator::applyGateZ</a></div><div class="ttdeci">void applyGateZ(CST qubitIndex)</div><div class="ttdoc">Apply the Pauli Z gate to the given qubit.</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00270">IntelSimulator.cpp:270</a></div></div>
<div class="ttc" id="a00915_html_a887bd799dbd0b5ce4bb556d6e6a87c2e"><div class="ttname"><a href="a00915.html#a887bd799dbd0b5ce4bb556d6e6a87c2e">QNLP::IntelSimulator::getGateI</a></div><div class="ttdeci">TMDP getGateI()</div><div class="ttdoc">Get the Identity.</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00408">IntelSimulator.cpp:408</a></div></div>
<div class="ttc" id="a00915_html_ab4211903966f86217e50e2e813f7fb4c"><div class="ttname"><a href="a00915.html#ab4211903966f86217e50e2e813f7fb4c">QNLP::IntelSimulator::qubitRegister</a></div><div class="ttdeci">QRDP qubitRegister</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00737">IntelSimulator.cpp:737</a></div></div>
<div class="ttc" id="a00915_html_ad8f8e0e08d4154218c80c863b2a53748"><div class="ttname"><a href="a00915.html#ad8f8e0e08d4154218c80c863b2a53748">QNLP::IntelSimulator::getQubitRegister</a></div><div class="ttdeci">QubitRegister&lt; ComplexDP &gt; &amp; getQubitRegister()</div><div class="ttdoc">Get the Qubit Register object.</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00605">IntelSimulator.cpp:605</a></div></div>
<div class="ttc" id="a00915_html_aaf47c02dc0ca86d12656a3ec6f365923"><div class="ttname"><a href="a00915.html#aaf47c02dc0ca86d12656a3ec6f365923">QNLP::IntelSimulator::applyGateY</a></div><div class="ttdeci">void applyGateY(CST qubitIndex)</div><div class="ttdoc">Apply the Pauli Y gate to the given qubit.</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00253">IntelSimulator.cpp:253</a></div></div>
<div class="ttc" id="a00915_html_a6bcf77000411cf461ab73ebf0854cded"><div class="ttname"><a href="a00915.html#a6bcf77000411cf461ab73ebf0854cded">QNLP::IntelSimulator::applyGateCH</a></div><div class="ttdeci">void applyGateCH(CST control, CST target)</div><div class="ttdoc">Apply Controlled Hadamard on target qubit.</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00496">IntelSimulator.cpp:496</a></div></div>
<div class="ttc" id="a00213_html_ae184342e3a272e0fc184cff4ad95be05"><div class="ttname"><a href="a00213.html#ae184342e3a272e0fc184cff4ad95be05">ncu_opt_tester.sim</a></div><div class="ttdeci">sim</div><div class="ttdef"><b>Definition:</b> <a href="a00137_source.html#l00023">ncu_opt_tester.py:23</a></div></div>
<div class="ttc" id="a00915_html_ac48b25386f58f74dd3d10e627350dbf6"><div class="ttname"><a href="a00915.html#ac48b25386f58f74dd3d10e627350dbf6">QNLP::IntelSimulator::applyGatePhaseShift</a></div><div class="ttdeci">void applyGatePhaseShift(std::size_t qubit_idx, double angle)</div><div class="ttdoc">Apply phase shift to given Qubit; [[1 0] [0 exp(i*angle)]].</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00156">IntelSimulator.cpp:156</a></div></div>
<div class="ttc" id="a00915_html"><div class="ttname"><a href="a00915.html">QNLP::IntelSimulator</a></div><div class="ttdoc">Class definition for IntelSimulator. The purpose of this class is to map the functionality of the und...</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00035">IntelSimulator.cpp:35</a></div></div>
<div class="ttc" id="a00915_html_a6d4de4ce0949808aa78de821963f872a"><div class="ttname"><a href="a00915.html#a6d4de4ce0949808aa78de821963f872a">QNLP::IntelSimulator::IntelSimulator</a></div><div class="ttdeci">IntelSimulator(int numQubits, bool useFusion=false)</div><div class="ttdoc">Construct a new Intel Simulator object. The constructor also sets up and initialises the MPI environe...</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00047">IntelSimulator.cpp:47</a></div></div>
<div class="ttc" id="a00915_html_a73f384f66de4ba97cd426c1e5410a78d"><div class="ttname"><a href="a00915.html#a73f384f66de4ba97cd426c1e5410a78d">QNLP::IntelSimulator::~IntelSimulator</a></div><div class="ttdeci">~IntelSimulator()</div><div class="ttdoc">Destroy the Intel Simulator object.</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00111">IntelSimulator.cpp:111</a></div></div>
<div class="ttc" id="a00213_html_a6f94e534a55034c30f887d6e511c7a53"><div class="ttname"><a href="a00213.html#a6f94e534a55034c30f887d6e511c7a53">ncu_opt_tester.rank</a></div><div class="ttdeci">rank</div><div class="ttdef"><b>Definition:</b> <a href="a00137_source.html#l00016">ncu_opt_tester.py:16</a></div></div>
<div class="ttc" id="a00915_html_a8cb090928af400c512c8aa1b745826ed"><div class="ttname"><a href="a00915.html#a8cb090928af400c512c8aa1b745826ed">QNLP::IntelSimulator::QRDP</a></div><div class="ttdeci">QubitRegister&lt; ComplexDP &gt; QRDP</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00038">IntelSimulator.cpp:38</a></div></div>
<div class="ttc" id="a00915_html_a46719f99c713d54a948b3da6425db4f7"><div class="ttname"><a href="a00915.html#a46719f99c713d54a948b3da6425db4f7">QNLP::IntelSimulator::applyGateCZ</a></div><div class="ttdeci">void applyGateCZ(CST control, CST target)</div><div class="ttdoc">Apply Controlled Pauli-Z on target qubit.</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00478">IntelSimulator.cpp:478</a></div></div>
<div class="ttc" id="a00915_html_aefafa25d795ca696ee7c44f4ee44017d"><div class="ttname"><a href="a00915.html#aefafa25d795ca696ee7c44f4ee44017d">QNLP::IntelSimulator::CST</a></div><div class="ttdeci">const std::size_t CST</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00039">IntelSimulator.cpp:39</a></div></div>
<div class="ttc" id="a00923_html_a913db3f649fd704afcf75f4f8e9789de"><div class="ttname"><a href="a00923.html#a913db3f649fd704afcf75f4f8e9789de">QNLP::SimulatorGeneral&lt; IntelSimulator &gt;::applyGateNCU</a></div><div class="ttdeci">void applyGateNCU(const Mat2x2Type &amp;U, const std::vector&lt; std::size_t &gt; &amp;ctrlIndices, std::size_t target, std::string label)</div><div class="ttdoc">Apply n-control unitary gate to the given qubit target.</div><div class="ttdef"><b>Definition:</b> <a href="a00167_source.html#l00462">Simulator.hpp:462</a></div></div>
<div class="ttc" id="a00923_html"><div class="ttname"><a href="a00923.html">QNLP::SimulatorGeneral</a></div><div class="ttdoc">CRTP defined class for simulator implementations.</div><div class="ttdef"><b>Definition:</b> <a href="a00167_source.html#l00069">Simulator.hpp:69</a></div></div>
<div class="ttc" id="a00214_html_a4f33114707dbbca9a2fdf04086d1c89b"><div class="ttname"><a href="a00214.html#a4f33114707dbbca9a2fdf04086d1c89b">QNLP_EndToEnd_MPI.x</a></div><div class="ttdeci">x</div><div class="ttdef"><b>Definition:</b> <a href="a00140_source.html#l00424">QNLP_EndToEnd_MPI.py:424</a></div></div>
<div class="ttc" id="a00167_html"><div class="ttname"><a href="a00167.html">Simulator.hpp</a></div></div>
<div class="ttc" id="a00915_html_a76bc3e5b319aa1bda8b10ad422664b35"><div class="ttname"><a href="a00915.html#a76bc3e5b319aa1bda8b10ad422664b35">QNLP::IntelSimulator::numQubits</a></div><div class="ttdeci">std::size_t numQubits</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00736">IntelSimulator.cpp:736</a></div></div>
<div class="ttc" id="a00915_html_ad994a3061e6e9901f81a1a872852baf5"><div class="ttname"><a href="a00915.html#ad994a3061e6e9901f81a1a872852baf5">QNLP::IntelSimulator::applyAmplitudeNorm</a></div><div class="ttdeci">void applyAmplitudeNorm()</div><div class="ttdoc">Apply normalization to the amplitudes of each state. This is required after a qubit in a state is col...</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00642">IntelSimulator.cpp:642</a></div></div>
<div class="ttc" id="a00915_html_a8f903350d87f40517431ab2c6af58d19"><div class="ttname"><a href="a00915.html#a8f903350d87f40517431ab2c6af58d19">QNLP::IntelSimulator::applyGateU</a></div><div class="ttdeci">void applyGateU(const TMDP &amp;U, CST qubitIndex, std::string label=&quot;U&quot;)</div><div class="ttdoc">Apply arbitrary user-defined unitary gate to qubit at qubit_idx.</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00121">IntelSimulator.cpp:121</a></div></div>
<div class="ttc" id="a00915_html_a51bf3d357cec1d6fa1e2ac98a604307c"><div class="ttname"><a href="a00915.html#a51bf3d357cec1d6fa1e2ac98a604307c">QNLP::IntelSimulator::getStateProbability</a></div><div class="ttdeci">double getStateProbability(CST target)</div><div class="ttdoc">Get the probability of the specified qubit being in the state |1&gt;</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00768">IntelSimulator.cpp:768</a></div></div>
<div class="ttc" id="a00915_html_ad4e8dfa039aceddd2918675c0e99daed"><div class="ttname"><a href="a00915.html#ad4e8dfa039aceddd2918675c0e99daed">QNLP::IntelSimulator::getGateCounts</a></div><div class="ttdeci">std::pair&lt; std::size_t, std::size_t &gt; getGateCounts()</div><div class="ttdoc">Print 1 and 2 qubit gate call counts.</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00709">IntelSimulator.cpp:709</a></div></div>
<div class="ttc" id="a00915_html_af2c1644dec4b763dbb588f467b3b536f"><div class="ttname"><a href="a00915.html#af2c1644dec4b763dbb588f467b3b536f">QNLP::IntelSimulator::applyGateCY</a></div><div class="ttdeci">void applyGateCY(CST control, CST target)</div><div class="ttdoc">Apply Controlled Pauli-Y on target qubit.</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00460">IntelSimulator.cpp:460</a></div></div>
<div class="ttc" id="a00915_html_a28932132916eef9cfbcc9c0bc992b40a"><div class="ttname"><a href="a00915.html#a28932132916eef9cfbcc9c0bc992b40a">QNLP::IntelSimulator::applyGateI</a></div><div class="ttdeci">void applyGateI(std::size_t qubitIndex)</div><div class="ttdoc">Apply the Identity gate to the given qubit.</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00138">IntelSimulator.cpp:138</a></div></div>
<div class="ttc" id="a00915_html_a581abd823527de7995b96733f543400f"><div class="ttname"><a href="a00915.html#a581abd823527de7995b96733f543400f">QNLP::IntelSimulator::initRegister</a></div><div class="ttdeci">void initRegister()</div><div class="ttdoc">(Re)Initialise the underlying register of the encapsulated simulator to well-defined state (|0....</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00631">IntelSimulator.cpp:631</a></div></div>
<div class="ttc" id="a00213_html_a04d504e3a1d9b0157c4d2d1de832d0ed"><div class="ttname"><a href="a00213.html#a04d504e3a1d9b0157c4d2d1de832d0ed">ncu_opt_tester.target</a></div><div class="ttdeci">int target</div><div class="ttdef"><b>Definition:</b> <a href="a00137_source.html#l00021">ncu_opt_tester.py:21</a></div></div>
<div class="ttc" id="a00915_html_a62fc6787ce4914d3b6161fb9a76ef08a"><div class="ttname"><a href="a00915.html#a62fc6787ce4914d3b6161fb9a76ef08a">QNLP::IntelSimulator::applyGateSqrtSwap</a></div><div class="ttdeci">void applyGateSqrtSwap(std::size_t qubit_idx0, std::size_t qubit_idx1)</div><div class="ttdoc">Performs Sqrt SWAP gate between two given qubits (half way SWAP)</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00180">IntelSimulator.cpp:180</a></div></div>
<div class="ttc" id="a00915_html_a80959381c3720a0d5913fbed8bba47c6"><div class="ttname"><a href="a00915.html#a80959381c3720a0d5913fbed8bba47c6">QNLP::IntelSimulator::rd</a></div><div class="ttdeci">std::random_device rd</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00746">IntelSimulator.cpp:746</a></div></div>
<div class="ttc" id="a00915_html_acdf09215d1b39443b770bca3275a340d"><div class="ttname"><a href="a00915.html#acdf09215d1b39443b770bca3275a340d">QNLP::IntelSimulator::applyGateCX</a></div><div class="ttdeci">void applyGateCX(CST control, CST target)</div><div class="ttdoc">Apply Controlled Pauli-X (CNOT) on target qubit.</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00442">IntelSimulator.cpp:442</a></div></div>
<div class="ttc" id="a00915_html_a08e6026c906a5ff51554eee2e225d0ad"><div class="ttname"><a href="a00915.html#a08e6026c906a5ff51554eee2e225d0ad">QNLP::IntelSimulator::applyGateCU</a></div><div class="ttdeci">void applyGateCU(const TMDP &amp;U, CST control, CST target, std::string label=&quot;U&quot;)</div><div class="ttdoc">Apply the given controlled unitary gate on target qubit.</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00424">IntelSimulator.cpp:424</a></div></div>
<div class="ttc" id="a00915_html_a0a3948c5a2d3ce931c865585a677e4ea"><div class="ttname"><a href="a00915.html#a0a3948c5a2d3ce931c865585a677e4ea">QNLP::IntelSimulator::applyGateCPhaseShift</a></div><div class="ttdeci">void applyGateCPhaseShift(double angle, unsigned int control, unsigned int target)</div><div class="ttdoc">Perform controlled phase shift gate.</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00515">IntelSimulator.cpp:515</a></div></div>
<div class="ttc" id="a00915_html_ab77ddab0c25debb25f5b894ff14c6c2e"><div class="ttname"><a href="a00915.html#ab77ddab0c25debb25f5b894ff14c6c2e">QNLP::IntelSimulator::applyGateRotZ</a></div><div class="ttdeci">void applyGateRotZ(CST qubitIndex, double angle)</div><div class="ttdoc">Apply the given Rotation about Z-axis to the given qubit.</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00370">IntelSimulator.cpp:370</a></div></div>
<div class="ttc" id="a00915_html_a0dfad24a46b55360a0cd8c329d2bbe8f"><div class="ttname"><a href="a00915.html#a0dfad24a46b55360a0cd8c329d2bbe8f">QNLP::IntelSimulator::applyGateSwap</a></div><div class="ttdeci">void applyGateSwap(CST qubit_idx0, CST qubit_idx1)</div><div class="ttdoc">Swap the qubits at the given indices.</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00593">IntelSimulator.cpp:593</a></div></div>
<div class="ttc" id="a00915_html_a19c3da1a6ca8811caa035c39b3540250"><div class="ttname"><a href="a00915.html#a19c3da1a6ca8811caa035c39b3540250">QNLP::IntelSimulator::TMDP</a></div><div class="ttdeci">qhipster::TinyMatrix&lt; ComplexDP, 2, 2, 32 &gt; TMDP</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00037">IntelSimulator.cpp:37</a></div></div>
<div class="ttc" id="a00915_html_a7c706fbd851f173bdd16256612a9aff3"><div class="ttname"><a href="a00915.html#a7c706fbd851f173bdd16256612a9aff3">QNLP::IntelSimulator::getGateX</a></div><div class="ttdeci">TMDP getGateX()</div><div class="ttdoc">Get the Pauli-X gate.</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00390">IntelSimulator.cpp:390</a></div></div>
<div class="ttc" id="a00915_html_aeee1c73eabef7e77a5fb7e4d92078f69"><div class="ttname"><a href="a00915.html#aeee1c73eabef7e77a5fb7e4d92078f69">QNLP::IntelSimulator::mt</a></div><div class="ttdeci">std::mt19937 mt</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00747">IntelSimulator.cpp:747</a></div></div>
<div class="ttc" id="a00915_html_a24f5444aac8c1c79c491f086e6871fb5"><div class="ttname"><a href="a00915.html#a24f5444aac8c1c79c491f086e6871fb5">QNLP::IntelSimulator::applyGateCRotY</a></div><div class="ttdeci">void applyGateCRotY(CST control, CST target, double theta)</div><div class="ttdoc">Apply the given Controlled Rotation about Y-axis to the given qubit.</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00556">IntelSimulator.cpp:556</a></div></div>
<div class="ttc" id="a00915_html_a4a4f93789161c8f6db5e90af27a17926"><div class="ttname"><a href="a00915.html#a4a4f93789161c8f6db5e90af27a17926">QNLP::IntelSimulator::applyGateH</a></div><div class="ttdeci">void applyGateH(CST qubitIndex)</div><div class="ttdoc">Apply the Hadamard gate to the given qubit.</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00287">IntelSimulator.cpp:287</a></div></div>
<div class="ttc" id="a00915_html_a1e3a2ffb531f7f8fbbe032619e9be1f3"><div class="ttname"><a href="a00915.html#a1e3a2ffb531f7f8fbbe032619e9be1f3">QNLP::IntelSimulator::collapseQubit</a></div><div class="ttdeci">void collapseQubit(CST target, bool collapseValue)</div><div class="ttdoc">Collapses specified qubit in register to the collapseValue without applying normalization.</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00758">IntelSimulator.cpp:758</a></div></div>
<div class="ttc" id="a00915_html_a6f85ad3d770635f47de48628c7d30335"><div class="ttname"><a href="a00915.html#a6f85ad3d770635f47de48628c7d30335">QNLP::IntelSimulator::getNumQubits</a></div><div class="ttdeci">std::size_t getNumQubits()</div><div class="ttdoc">Get the number of Qubits.</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00623">IntelSimulator.cpp:623</a></div></div>
<div class="ttc" id="a00915_html_a82d309be4f120c7d9083ea2c575b2593"><div class="ttname"><a href="a00915.html#a82d309be4f120c7d9083ea2c575b2593">QNLP::IntelSimulator::PrintStates</a></div><div class="ttdeci">void PrintStates(std::string x, std::vector&lt; std::size_t &gt; qubits={})</div><div class="ttdoc">Prints the string x and then for each state of the specified qubits in the superposition,...</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00690">IntelSimulator.cpp:690</a></div></div>
<div class="ttc" id="a00915_html_a1f4431219d1382604100f5a121b0cacd"><div class="ttname"><a href="a00915.html#a1f4431219d1382604100f5a121b0cacd">QNLP::IntelSimulator::applyMeasurement</a></div><div class="ttdeci">bool applyMeasurement(CST target, bool normalize=true)</div><div class="ttdoc">Apply measurement to a target qubit, randomly collapsing the qubit proportional to the amplitude and ...</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00653">IntelSimulator.cpp:653</a></div></div>
<div class="ttc" id="a00915_html_aadd236084622d0c4e63b2d0b23906df3"><div class="ttname"><a href="a00915.html#aadd236084622d0c4e63b2d0b23906df3">QNLP::IntelSimulator::dist</a></div><div class="ttdeci">std::uniform_real_distribution&lt; double &gt; dist</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00748">IntelSimulator.cpp:748</a></div></div>
<div class="ttc" id="a00915_html_aa1baac16280fbf47655a252e3e3c82d6"><div class="ttname"><a href="a00915.html#aa1baac16280fbf47655a252e3e3c82d6">QNLP::IntelSimulator::gates</a></div><div class="ttdeci">std::vector&lt; TMDP &gt; gates</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00738">IntelSimulator.cpp:738</a></div></div>
<div class="ttc" id="a00915_html_ab996963a9a49fcc3d9a07b1b1c8a62a7"><div class="ttname"><a href="a00915.html#ab996963a9a49fcc3d9a07b1b1c8a62a7">QNLP::IntelSimulator::applyGateCCX</a></div><div class="ttdeci">void applyGateCCX(std::size_t ctrl_qubit0, std::size_t ctrl_qubit1, std::size_t target_qubit)</div><div class="ttdoc">Controlled controlled NOT (CCNOT, CCX) gate.</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00193">IntelSimulator.cpp:193</a></div></div>
<div class="ttc" id="a00186_html"><div class="ttname"><a href="a00186.html">QNLP</a></div><div class="ttdef"><b>Definition:</b> <a href="a00002_source.html#l00019">bin_into_superpos.hpp:19</a></div></div>
<div class="ttc" id="a00915_html_a1d39e14e2dd84806934d5289ea609684"><div class="ttname"><a href="a00915.html#a1d39e14e2dd84806934d5289ea609684">QNLP::IntelSimulator::gate_count_1qubit</a></div><div class="ttdeci">std::size_t gate_count_1qubit</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00743">IntelSimulator.cpp:743</a></div></div>
<div class="ttc" id="a00915_html_a36b27d528184068d64b92f7f8434b1dc"><div class="ttname"><a href="a00915.html#a36b27d528184068d64b92f7f8434b1dc">QNLP::IntelSimulator::applyGateRotY</a></div><div class="ttdeci">void applyGateRotY(CST qubitIndex, double angle)</div><div class="ttdoc">Apply the given Rotation about Y-axis to the given qubit.</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00348">IntelSimulator.cpp:348</a></div></div>
<div class="ttc" id="a00915_html_aa695c0a90d6d780a0f9962e3ac0d2b8f"><div class="ttname"><a href="a00915.html#aa695c0a90d6d780a0f9962e3ac0d2b8f">QNLP::IntelSimulator::applyGateCSwap</a></div><div class="ttdeci">void applyGateCSwap(std::size_t ctrl_qubit, std::size_t qubit_swap0, std::size_t qubit_swap1)</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00205">IntelSimulator.cpp:205</a></div></div>
<div class="ttc" id="a00915_html_ab000ae3085d5c352d8de5bc641d3897b"><div class="ttname"><a href="a00915.html#ab000ae3085d5c352d8de5bc641d3897b">QNLP::IntelSimulator::applyGateCRotZ</a></div><div class="ttdeci">void applyGateCRotZ(CST control, CST target, const double theta)</div><div class="ttdoc">Apply the given Controlled Rotation about Z-axis to the given qubit.</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00575">IntelSimulator.cpp:575</a></div></div>
<div class="ttc" id="a00065_html"><div class="ttname"><a href="a00065.html">GateWriter.hpp</a></div></div>
<div class="ttc" id="a00915_html_aa26612617dcd33ca2ab74be8bd23bc29"><div class="ttname"><a href="a00915.html#aa26612617dcd33ca2ab74be8bd23bc29">QNLP::IntelSimulator::overlap</a></div><div class="ttdeci">complex&lt; double &gt; overlap(IntelSimulator &amp;sim)</div><div class="ttdoc">Compute overlap between different simulators. Number of qubits must be the same.</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00723">IntelSimulator.cpp:723</a></div></div>
<div class="ttc" id="a00915_html_ac99bc35f19ea72ba763b1e45d3911303"><div class="ttname"><a href="a00915.html#ac99bc35f19ea72ba763b1e45d3911303">QNLP::IntelSimulator::getGateY</a></div><div class="ttdeci">TMDP getGateY()</div><div class="ttdoc">Get the Pauli-Y gate.</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00396">IntelSimulator.cpp:396</a></div></div>
<div class="ttc" id="a00923_html_a363ca18f6710cc1f4bcdb0f4f27aa197"><div class="ttname"><a href="a00923.html#a363ca18f6710cc1f4bcdb0f4f27aa197">QNLP::SimulatorGeneral&lt; IntelSimulator &gt;::initCaches</a></div><div class="ttdeci">void initCaches()</div><div class="ttdoc">Initialise caches used in NCU operation.</div><div class="ttdef"><b>Definition:</b> <a href="a00167_source.html#l00687">Simulator.hpp:687</a></div></div>
<div class="ttc" id="a00915_html_a9bf211252e52181d0fb6a40845a5cd10"><div class="ttname"><a href="a00915.html#a9bf211252e52181d0fb6a40845a5cd10">QNLP::IntelSimulator::collapseToBasisZ</a></div><div class="ttdeci">void collapseToBasisZ(CST target, bool collapseValue)</div><div class="ttdoc">Apply measurement to a target qubit with respect to the Z-basis, collapsing to a specified value (0 o...</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00679">IntelSimulator.cpp:679</a></div></div>
<div class="ttc" id="a00915_html_a5c78cca0cfdd70e56fd5c228906c59d4"><div class="ttname"><a href="a00915.html#a5c78cca0cfdd70e56fd5c228906c59d4">QNLP::IntelSimulator::applyGateSqrtX</a></div><div class="ttdeci">void applyGateSqrtX(CST qubitIndex)</div><div class="ttdoc">Apply the Sqrt{Pauli X} gate to the given qubit.</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00304">IntelSimulator.cpp:304</a></div></div>
<div class="ttc" id="a00915_html_a5410fae00e77298bb6a85cabd3eba4f0"><div class="ttname"><a href="a00915.html#a5410fae00e77298bb6a85cabd3eba4f0">QNLP::IntelSimulator::applyGateRotX</a></div><div class="ttdeci">void applyGateRotX(CST qubitIndex, double angle)</div><div class="ttdoc">Apply the given Rotation about X-axis to the given qubit.</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00326">IntelSimulator.cpp:326</a></div></div>
<div class="ttc" id="a00915_html_a129cbf4d467a90ee41b23378059060a5"><div class="ttname"><a href="a00915.html#a129cbf4d467a90ee41b23378059060a5">QNLP::IntelSimulator::getGateZ</a></div><div class="ttdeci">TMDP getGateZ()</div><div class="ttdoc">Get the Pauli-Z gate.</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00402">IntelSimulator.cpp:402</a></div></div>
<div class="ttc" id="a00923_html_acdbbba66d5941954ed70b9edc0e5174d"><div class="ttname"><a href="a00923.html#acdbbba66d5941954ed70b9edc0e5174d">QNLP::SimulatorGeneral&lt; IntelSimulator &gt;::matrixSqrt</a></div><div class="ttdeci">Mat2x2Type matrixSqrt(const Mat2x2Type &amp;U)</div><div class="ttdoc">Calculates the unitary matrix square root (U == VV, where V is returned)</div><div class="ttdef"><b>Definition:</b> <a href="a00167_source.html#l00729">Simulator.hpp:729</a></div></div>
<div class="ttc" id="a00915_html_a3dbe650a7d4634a6c68c464dbc71cb43"><div class="ttname"><a href="a00915.html#a3dbe650a7d4634a6c68c464dbc71cb43">QNLP::IntelSimulator::applyGateX</a></div><div class="ttdeci">void applyGateX(CST qubitIndex)</div><div class="ttdoc">Apply the Pauli X gate to the given qubit.</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00236">IntelSimulator.cpp:236</a></div></div>
<div class="ttc" id="a00915_html_abefd66d9f607eb1741e982e0b30f747f"><div class="ttname"><a href="a00915.html#abefd66d9f607eb1741e982e0b30f747f">QNLP::IntelSimulator::getGateH</a></div><div class="ttdeci">TMDP getGateH()</div><div class="ttdoc">Get the Hadamard gate.</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00414">IntelSimulator.cpp:414</a></div></div>
<div class="ttc" id="a00915_html_a43a6f6053266f2df36ed2ad96224ed62"><div class="ttname"><a href="a00915.html#a43a6f6053266f2df36ed2ad96224ed62">QNLP::IntelSimulator::getQubitRegister</a></div><div class="ttdeci">const QubitRegister&lt; ComplexDP &gt; &amp; getQubitRegister() const</div><div class="ttdoc">Get the Qubit Register object.</div><div class="ttdef"><b>Definition:</b> <a href="a00158_source.html#l00614">IntelSimulator.cpp:614</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_da17d78632561013a94c09e29a703cf4.html">intel-qnlp-rc2</a></li><li class="navelem"><a class="el" href="dir_1ee3393be4a977752a56b41968766bfc.html">modules</a></li><li class="navelem"><a class="el" href="dir_6be5c9505bc8ea812ddfc75ab34af588.html">simulator</a></li><li class="navelem"><a class="el" href="a00158.html">IntelSimulator.cpp</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.15 </li>
  </ul>
</div>
</body>
</html>
